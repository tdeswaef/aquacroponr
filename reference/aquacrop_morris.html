<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="aquacrop_morris operates in 5 steps:
Define the morris design in terms of parameters, parameter ranges, trajectories and method. See also the morris function in the sensitivity package.
Run the AquaCrop model with all parameter combinations from the morris design.
Choose the level of integration: model time steps, different variables
Make an array with the correct dimensions based on the simulations (step 2) and the integration level (step 3).
tell the array to the morris design from step 1.

"><title>A wrapper function for running a sensitivity analysis for AquaCrop using the morris method — aquacrop_morris • AquacropOnR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A wrapper function for running a sensitivity analysis for AquaCrop using the morris method — aquacrop_morris"><meta property="og:description" content="aquacrop_morris operates in 5 steps:
Define the morris design in terms of parameters, parameter ranges, trajectories and method. See also the morris function in the sensitivity package.
Run the AquaCrop model with all parameter combinations from the morris design.
Choose the level of integration: model time steps, different variables
Make an array with the correct dimensions based on the simulations (step 2) and the integration level (step 3).
tell the array to the morris design from step 1.

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AquacropOnR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/crop-parameters.html">Crop parameter table</a>
    <a class="dropdown-item" href="../articles/example-morris.html">Sensitivity analysis example with Morris method</a>
    <a class="dropdown-item" href="../articles/example-simulation.html">Simulation Example for Spinach</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>A wrapper function for running a sensitivity analysis for AquaCrop using the morris method</h1>
      
      <div class="d-none name"><code>aquacrop_morris.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>aquacrop_morris</code> operates in 5 steps:</p><ol><li><p>Define the morris design in terms of parameters, parameter ranges, trajectories and method. See also the <code>morris</code> function in the <a href="sensitivity%20package">sensitivity package</a>.</p></li>
<li><p>Run the AquaCrop model with all parameter combinations from the morris design.</p></li>
<li><p>Choose the level of integration: model time steps, different variables</p></li>
<li><p>Make an array with the correct dimensions based on the simulations (step 2) and the integration level (step 3).</p></li>
<li><p><code>tell</code> the array to the morris design from step 1.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aquacrop_morris</span><span class="op">(</span></span>
<span>  situation <span class="op">=</span> <span class="st">"S_01"</span>,</span>
<span>  <span class="va">cycle_length</span>,</span>
<span>  backgroundpar <span class="op">=</span> <span class="va">Spinach</span>,</span>
<span>  r <span class="op">=</span> <span class="va">r</span>,</span>
<span>  binf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  bsup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"oat"</span>, levels <span class="op">=</span> <span class="fl">8</span>, grid.jump <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  outvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Biomass"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>situation</dt>
<dd><p>character string or vector of scenarios to run</p></dd>


<dt>backgroundpar</dt>
<dd><p>the reference parameter set (as made by <code>read_CRO</code>)</p></dd>


<dt>r</dt>
<dd><p>number of trajectories in the morris algorithm</p></dd>


<dt>binf</dt>
<dd><p>named vector with lower boundaries of the parameter ranges</p></dd>


<dt>bsup</dt>
<dd><p>named vector with upper boundaries of the parameter ranges</p></dd>


<dt>design</dt>
<dd><p>list for designing the morris algorithm</p></dd>


<dt>outvars</dt>
<dd><p>character vector with output variable names for the sensitivity analysis</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a list of class <code>morris</code>, containing all the input arguments, plus the following components:</p>


<p><code>call</code>: the matched call</p>


<p><code>X</code> a <code>data.frame</code> containing the design of experiments (parameter value combinations)</p>


<p><code>y</code> either a vector, a matrix or a three-dimensional array of model responses (depends on the output of model)</p>


<p><code>ee</code>:</p><ul><li><p>if y is a vector: a \((r \times p)\) - matrix of elementary effects for all the factors.</p></li>
<li><p>if y is a matrix: a \((r \times p \times ncol(y))\) - array of elementary effects for all the factors and all columns of y.</p></li>
<li><p>if y is a three-dimensional array: a \((r \times p \times dim(y)[2] \times dim(y)[3])\) - array of elementary effects for all the factors and all elements of the second and third dimension of y.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">Scenario_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="design_scenario.html">design_scenario</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"S_01"</span>,</span></span>
<span class="r-in"><span>    Plant_Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-04-01"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    IRRI <span class="op">=</span> <span class="st">"IRRI_01"</span>,</span></span>
<span class="r-in"><span>    Soil <span class="op">=</span> <span class="st">"Soil_01"</span>,</span></span>
<span class="r-in"><span>    Plu <span class="op">=</span> <span class="st">"Plu_01"</span>,</span></span>
<span class="r-in"><span>    Tnx <span class="op">=</span> <span class="st">"Tnx_01"</span>,</span></span>
<span class="r-in"><span>    ETo <span class="op">=</span> <span class="st">"ETo_01"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in length_check_fun(Input_Date, no_scenarios):</span> argument "Input_Date" is missing, with no default</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">aquacrop_morris</span><span class="op">(</span>situation <span class="op">=</span> <span class="st">"S_01"</span>, backgroundpar<span class="op">=</span><span class="va">Spinach</span>, r <span class="op">=</span> <span class="fl">20</span>, binf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>rt_max <span class="op">=</span> <span class="fl">0.12</span>, cgc <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, bsup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>rt_max <span class="op">=</span> <span class="fl">0.55</span>, cgc <span class="op">=</span> <span class="fl">0.21</span><span class="op">)</span>, outvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Biomass"</span>, <span class="st">"YSdryS"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>keeping 19 repetitions out of 20</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in map(., function(i) aquacrop_wrapper(param_values = mo$X[i, ],     situation = situation, cycle_length = cycle_length, model_options = list(AQ = AQ,         defaultpar = backgroundpar, output = "morris")) %&gt;% dplyr::mutate(x = i)):</span> <span style="color: #00BBBB;">ℹ</span> In index: 1.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Caused by error in `aquacrop_wrapper()`:</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> set your working directory to the AquaCrop.path</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Tom De Swaef.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

