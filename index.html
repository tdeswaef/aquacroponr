<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This package provides wrappers for using AquaCrop from within R as simple as possible. 
    This work was inspired on earlier initiatives for the APSIM (ApsimOnR) and STICS (SticsOnR) crop models. In doing so, the package aims to intercface AquaCRop to the CroptimizR package.">
<title>Function collection for using AquaCrop from R • AquacropOnR</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Function collection for using AquaCrop from R">
<meta property="og:description" content="This package provides wrappers for using AquaCrop from within R as simple as possible. 
    This work was inspired on earlier initiatives for the APSIM (ApsimOnR) and STICS (SticsOnR) crop models. In doing so, the package aims to intercface AquaCRop to the CroptimizR package.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">AquacropOnR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="aquacroponr">AquacropOnR<a class="anchor" aria-label="anchor" href="#aquacroponr"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of AquacropOnR is to make AquaCrop simulations from within <code>R</code> as easy as possible. The package has currently been tested with the AquaCrop standalone version 7.0 on Windows. The most recent version can be downloaded from the <a href="https://www.fao.org/aquacrop/software/aquacropplug-inprogramme/en/#c518670" class="external-link">FAO website</a>.</p>
<div class="section level2">
<h2 id="installation-and-setup">Installation and setup<a class="anchor" aria-label="anchor" href="#installation-and-setup"></a>
</h2>
<p>First install <a href="https://git-scm.com/downloads" class="external-link">git</a>. Then you can install the development version of <code>AquacropOnR</code> using the <code>devtools</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_git</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://github.com/tdeswaef/aquacroponr.git"</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The installation of the AquaCrop standalone version is required.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example to run AquaCrop from <code>R</code> for the spinach crop.</p>
<p>Importantly, the working directory should be set to the folder in which the <em>aquacrop.exe</em> file is located.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tdeswaef.github.io/aquacroponr/">AquacropOnR</a></span><span class="op">)</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span>dir <span class="op">=</span> <span class="va">path_to_aquacrop_folder</span><span class="op">)</span></span></code></pre></div>
<p>With the package comes an example list with default crop parameters for <strong>quinoa</strong> and <strong>spinach</strong>. To make this list for your own crop, you need an AquaCrop cropfile (<em>YourCrop.CRO</em>) whose path should be input in the <code><a href="reference/read_CRO.html">read_CRO()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>yourcrop <span class="ot">&lt;-</span> <span class="fu">read_CRO</span>(<span class="st">"path/YourCrop.CRO"</span>)<span class="st">`</span><span class="at"> </span></span></code></pre></div>
<p>Once you have the list with default crop parameter values, you can design the scenario’s for which you want to run AquaCrop. The <code>AquacropOnR</code> package provides a function to design the scenario’s: <code><a href="reference/design_scenario.html">design_scenario()</a></code>. The arguments in this function have the following meaning:</p>
<ul>
<li>
<code>name</code> is a character vector of names for the scenario’s.</li>
<li>
<code>Input_Date</code> is a Date vector that indicates the start point of the meteo files (<code>Plu</code>, <code>Tnx</code>, <code>ETo</code>)<br>
</li>
<li>
<code>Plant_Date</code> is a Date vector that defines the planting date in each scenario<br>
</li>
<li>
<code>IRRI</code> is a character vector of the names of the irrigation scenario’s present in the <code>ID</code> column of the <code>IRRI_s</code> tibble.<br>
</li>
<li>
<code>Soil</code> is a character vector of the names of the soils present in the <code>ID</code> column of the <code>SOL_s</code> tibble.</li>
<li>
<code>Plu</code>, <code>Tnx</code>, and <code>ETo</code> are character (vectors) that refer to the names of <code>R</code> objects, that hold the daily data for precipitation, temperature and reference evapotranspiration, respectively.</li>
</ul>
<p><strong>IMPORTANT</strong>:</p>
<ul>
<li>The Scenario_s tibble <strong>must</strong> be named <code>Scenario_s</code> and <strong>must</strong> have the columns (variables) <code>Scenario</code>, <code>Input_Date</code>, <code>Plant_Date</code>, <code>IRRI</code>, <code>Soil</code> and <code>Meteo</code>.<br>
</li>
<li>The irrigation tibble <strong>must</strong> be named <code>IRRI_s</code> and <strong>must</strong> have the columns <code>ID</code>, <code>Timing</code>, <code>Depth</code> and <code>ECw</code>. Values of the <code>ID</code> column are given as input to the <code>IRRI</code> argument in the <code><a href="reference/design_scenario.html">design_scenario()</a></code> function.<br>
</li>
<li>The soil tibble <strong>must</strong> be named <code>SOL_s</code> and <strong>must</strong> have the columns <code>ID</code>, <code>Horizon</code>, <code>Thickness</code>, <code>SAT</code>, <code>FC</code>, <code>WP</code>, <code>Ksat</code>, <code>Penetrability</code> and <code>Gravel</code>. Values of the <code>ID</code> column are given as input to the <code>Soil</code> argument in the <code><a href="reference/design_scenario.html">design_scenario()</a></code> function.<br>
</li>
<li>The precipitation tibble can be named as you want, but its name is the input to the <code>Plu</code> argument in the <code><a href="reference/design_scenario.html">design_scenario()</a></code> function. This tibble <strong>must</strong> have the columns <code>DAY</code> and <code>PLU</code>. The first value of <code>DAY</code> should be <code>1</code>, and its date should correspond to the value of the <code>Input_Date</code> argument in the <code>Scenario_s</code> tibble. All following <code>DAY</code> data need to be the number of days since the <code>Input_Date</code> value. These can span multiple years, so values exceeding 365 (or 366), refer to following years.<br>
</li>
<li>The reference evapotranspiration tibble can be named as you want, but its name is the input to the <code>ETo</code> argument in the <code><a href="reference/design_scenario.html">design_scenario()</a></code> function. This tibble <strong>must</strong> have the columns <code>DAY</code> and <code>ETo</code>. The first value of <code>DAY</code> should be <code>1</code>, and its date should correspond to the value of the <code>Input_Date</code> argument in the <code>Scenario_s</code> tibble. All following <code>DAY</code> data need to be the number of days since the <code>Input_Date</code> value. These can span multiple years, so values exceeding 365 (or 366), refer to following years.<br>
</li>
<li>The temperature tibble can be named as you want, but its name is the input to the <code>Tnx</code> argument in the <code><a href="reference/design_scenario.html">design_scenario()</a></code> function. This tibble <strong>must</strong> have the columns <code>DAY</code>, <code>TMAX</code> and <code>TMIN</code>. The first value of <code>DAY</code> should be <code>1</code>, and its date should correspond to the value of the <code>Input_Date</code> argument in the <code>Scenario_s</code> tibble. All following <code>DAY</code> data need to be the number of days since the <code>Input_Date</code> value. These can span multiple years, so values exceeding 365 (or 366), refer to following years.</li>
</ul>
<p>Examples of these tibbles are available from the package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Scenario_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/design_scenario.html">design_scenario</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"S_01"</span>,</span>
<span>                              Input_Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-01-01"</span><span class="op">)</span>,</span>
<span>                              Plant_Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-04-01"</span><span class="op">)</span>, </span>
<span>                              IRRI <span class="op">=</span> <span class="st">"IRRI_01"</span>, </span>
<span>                              Soil <span class="op">=</span> <span class="st">"Soil_01"</span>, </span>
<span>                              Plu <span class="op">=</span> <span class="st">"Plu_01"</span>,</span>
<span>                              Tnx <span class="op">=</span> <span class="st">"Tnx_01"</span>,</span>
<span>                              ETo <span class="op">=</span> <span class="st">"ETo_01"</span><span class="op">)</span></span>
<span><span class="va">Scenario_s</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 8</span></span>
<span><span class="co">#&gt;   Scenario Input_Date Plant_Date IRRI    Soil    Plu    Tnx    ETo   </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; </span></span>
<span><span class="co">#&gt; 1 S_01     2019-01-01 2019-04-01 IRRI_01 Soil_01 Plu_01 Tnx_01 ETo_01</span></span>
<span><span class="va">IRRI_s</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>ID <span class="op">=</span> <span class="st">"IRRI_01"</span>, Timing <span class="op">=</span> <span class="fl">20</span>, Depth <span class="op">=</span> <span class="fl">25</span>, ECw <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">SOL_s</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 9</span></span>
<span><span class="co">#&gt;   ID      Horizon Thickness   SAT    FC    WP  Ksat Penetrability Gravel</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Soil_01       1         4    41    22    10  1200           100      0</span></span>
<span><span class="va">Plu_01</span></span>
<span><span class="co">#&gt; # A tibble: 365 × 2</span></span>
<span><span class="co">#&gt;      DAY   PLU</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     1   0.4</span></span>
<span><span class="co">#&gt;  2     2   0.7</span></span>
<span><span class="co">#&gt;  3     3   0.8</span></span>
<span><span class="co">#&gt;  4     4   0.2</span></span>
<span><span class="co">#&gt;  5     5   0  </span></span>
<span><span class="co">#&gt;  6     6   0.3</span></span>
<span><span class="co">#&gt;  7     7   1.9</span></span>
<span><span class="co">#&gt;  8     8   6.5</span></span>
<span><span class="co">#&gt;  9     9   0.6</span></span>
<span><span class="co">#&gt; 10    10   5.2</span></span>
<span><span class="co">#&gt; # ℹ 355 more rows</span></span>
<span><span class="va">Tnx_01</span></span>
<span><span class="co">#&gt; # A tibble: 365 × 3</span></span>
<span><span class="co">#&gt;      DAY  TMAX  TMIN</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     1   9.3   7.2</span></span>
<span><span class="co">#&gt;  2     2   7.4   5  </span></span>
<span><span class="co">#&gt;  3     3   6.8   2.1</span></span>
<span><span class="co">#&gt;  4     4   6.5   2.5</span></span>
<span><span class="co">#&gt;  5     5   6.5   2.9</span></span>
<span><span class="co">#&gt;  6     6   7.4   4.3</span></span>
<span><span class="co">#&gt;  7     7   9.6   4.7</span></span>
<span><span class="co">#&gt;  8     8   8.5   6.6</span></span>
<span><span class="co">#&gt;  9     9   7.2   3.9</span></span>
<span><span class="co">#&gt; 10    10   7.4   1  </span></span>
<span><span class="co">#&gt; # ℹ 355 more rows</span></span>
<span><span class="va">ETo_01</span></span>
<span><span class="co">#&gt; # A tibble: 365 × 2</span></span>
<span><span class="co">#&gt;      DAY   ETo</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     1 1.03 </span></span>
<span><span class="co">#&gt;  2     2 1.17 </span></span>
<span><span class="co">#&gt;  3     3 0.743</span></span>
<span><span class="co">#&gt;  4     4 0.887</span></span>
<span><span class="co">#&gt;  5     5 0.778</span></span>
<span><span class="co">#&gt;  6     6 0.695</span></span>
<span><span class="co">#&gt;  7     7 0.693</span></span>
<span><span class="co">#&gt;  8     8 1.51 </span></span>
<span><span class="co">#&gt;  9     9 1.37 </span></span>
<span><span class="co">#&gt; 10    10 0.602</span></span>
<span><span class="co">#&gt; # ℹ 355 more rows</span></span></code></pre></div>
<p>Then it is crucial to create the correct AquaCrop path, while checking the required folders and choosing which daily outputs to produce. Therefore the package has the function <code>path_config()</code>. Make sure your path ends with a “/”.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AQ</span> <span class="op">&lt;-</span> <span class="fu">path_config</span><span class="op">(</span>AquaCrop.path <span class="op">=</span> <span class="va">path_to_aquacrop_folder</span>, Daily_output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can run AquaCrop using the <code><a href="reference/aquacrop_wrapper.html">aquacrop_wrapper()</a></code> function and display a plot. The <code>param_values</code> argument is used to modify crop parameters from the default, which is the list provided as input to the <code>defaultpar</code> argument inside the <code>model_options</code> list. <code>situation</code> takes a vector of characters, that correspond to the <code>Scenario</code> variable in the <code>Scenario_s</code> tibble.</p>
<p>Let us first run the simulation with the default parameters for spinach:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">default</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/aquacrop_wrapper.html">aquacrop_wrapper</a></span><span class="op">(</span>param_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>               situation <span class="op">=</span> <span class="st">"S_01"</span>,</span>
<span>               cycle_length <span class="op">=</span> <span class="fl">70</span>,</span>
<span>               model_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>AQ <span class="op">=</span> <span class="va">AQ</span>, defaultpar <span class="op">=</span> <span class="va">Spinach</span>, output <span class="op">=</span> <span class="st">"morris"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DAP</span>, y<span class="op">=</span><span class="va">Biomass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">default</span>, color <span class="op">=</span> <span class="st">'black'</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fl">40</span>, y<span class="op">=</span><span class="fl">3</span>, label <span class="op">=</span> <span class="st">'default'</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example3-1.png" width="90%"></p>
<p>And now let’s see what happens when we increase the canopy growth coefficient <code>cgc</code> from 0.15 to 0.18:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modified</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/aquacrop_wrapper.html">aquacrop_wrapper</a></span><span class="op">(</span>param_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cgc <span class="op">=</span> <span class="fl">0.18</span><span class="op">)</span>,</span>
<span>               situation <span class="op">=</span> <span class="st">"S_01"</span>,</span>
<span>               cycle_length <span class="op">=</span> <span class="fl">70</span>,</span>
<span>               model_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>AQ <span class="op">=</span> <span class="va">AQ</span>, defaultpar <span class="op">=</span> <span class="va">Spinach</span>, output <span class="op">=</span> <span class="st">"def"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DAP</span>, y<span class="op">=</span><span class="va">Biomass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">default</span>, color <span class="op">=</span> <span class="st">'black'</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fl">40</span>, y<span class="op">=</span><span class="fl">3</span>, label <span class="op">=</span> <span class="st">'default'</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">modified</span>, color <span class="op">=</span> <span class="st">'blue'</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fl">40</span>, y<span class="op">=</span><span class="fl">2.8</span>, label <span class="op">=</span> <span class="st">'modified'</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">'blue'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example4-1.png" width="90%"></p>
<p>A list of parameters with their explanation can be found in the <a href="Cropparameters.html">crop parameter file</a></p>
</div>
<div class="section level2">
<h2 id="example-morris-method">Example Morris method<a class="anchor" aria-label="anchor" href="#example-morris-method"></a>
</h2>
<p>For sensitivity analysis using the <code>morris</code> method you first design the morris sampling scheme and the simulations. Based on these results, you can then define for which level you want to calculate the elemental effects. First we run the Morris method using the <code>aquacrop_morris</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/aquacrop_morris.html">aquacrop_morris</a></span><span class="op">(</span>situation <span class="op">=</span> <span class="st">"S_01"</span>, </span>
<span>                     backgroundpar<span class="op">=</span><span class="va">Spinach</span>, </span>
<span>                     cycle_length <span class="op">=</span> <span class="fl">70</span>, </span>
<span>                     r <span class="op">=</span> <span class="fl">20</span>, </span>
<span>                     binf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>rt_max <span class="op">=</span> <span class="fl">0.12</span>, cgc <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, </span>
<span>                     bsup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>rt_max <span class="op">=</span> <span class="fl">0.55</span>, cgc <span class="op">=</span> <span class="fl">0.21</span><span class="op">)</span>, </span>
<span>                     outvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Biomass"</span>, <span class="st">"YSdryS"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then we create the interpretable dataframe from the elemental effects matrix:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">EE</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">$</span><span class="va">ee</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>value.name <span class="op">=</span> <span class="st">"ee"</span>, varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"traject"</span>, <span class="st">"par"</span>, <span class="st">"DAP"</span>, <span class="st">"output"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If you would have multiple scenarios in your analysis, then the DAP values can be split up by scenario:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">EE</span> <span class="op">&lt;-</span> <span class="va">EE</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Scenario <span class="op">=</span> <span class="op">(</span><span class="va">DAP</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">70</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,</span>
<span>                           DAP <span class="op">=</span> <span class="va">DAP</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">70</span><span class="op">)</span></span></code></pre></div>
<p>We can then choose the level of integration at which we want to summarise the elemental effects:</p>
<ul>
<li>By DAP and output variable</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_star1</span> <span class="op">&lt;-</span> <span class="va">EE</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">par</span>, <span class="va">DAP</span>, <span class="va">output</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ee</span><span class="op">)</span>,</span>
<span>            mu_star <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ee</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">ee</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mu_star1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span>facets <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">output</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DAP</span>, y<span class="op">=</span><span class="va">mu_star</span>, color <span class="op">=</span> <span class="va">par</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-morris4-1.png" width="90%"></p>
<ul>
<li>By output variable</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_star2</span> <span class="op">&lt;-</span> <span class="va">EE</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">par</span>, <span class="va">output</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ee</span><span class="op">)</span>,</span>
<span>            mu_star <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ee</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">ee</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mu_star2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span>facets <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">output</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">mu_star</span>, y<span class="op">=</span><span class="va">sigma</span>, color <span class="op">=</span> <span class="va">par</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-morris5-1.png" width="90%"></p>
</div>
<div class="section level2">
<h2 id="roadmap">Roadmap<a class="anchor" aria-label="anchor" href="#roadmap"></a>
</h2>
<ul class="task-list">
<li>
<input type="checkbox" disabled checked>definition of the AquaCrop wrapper function <code>aquacrop_wrapper</code><br>
</li>
<li>
<input type="checkbox" disabled checked>allow option to run AquaCrop on growing degree days instead of days<br>
</li>
<li>
<input type="checkbox" disabled checked>include code for running sensitivity analysis using the morris method</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing AquacropOnR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tom De Swaef <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8338-7786" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tom De Swaef.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
