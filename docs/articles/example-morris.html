<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="AquacropOnR">
<title>Sensitivity analysis example with Morris method • AquacropOnR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity analysis example with Morris method">
<meta property="og:description" content="AquacropOnR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AquacropOnR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/crop-parameters.html">Crop parameter table</a>
    <a class="dropdown-item" href="../articles/example-morris.html">Sensitivity analysis example with Morris method</a>
    <a class="dropdown-item" href="../articles/example-scenario.html">Example for scenario making</a>
    <a class="dropdown-item" href="../articles/example-simulation.html">Simulation Example for Spinach</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Sensitivity analysis example with Morris method</h1>
            
      
      
      <div class="d-none name"><code>example-morris.Rmd</code></div>
    </div>

    
    
<p>First run the code present in the
<code><a href="../articles/example-simulation.html">vignette("example-simulation")</a></code>, to ensure that the paths
are correct and that the scenarios have been defined.</p>
<p>For sensitivity analysis using the Morris method, we made the
function <code><a href="../reference/aquacrop_morris.html">aquacrop_morris()</a></code>, which is built upon the
<code><a href="https://rdrr.io/pkg/sensitivity/man/morris.html" class="external-link">sensitivity::morris()</a></code> function. This function designs the
Morris sampling scheme for <code>r</code> trajectories. In this case we
used <span class="math inline">\(r=20\)</span>, to limit the computation
time, but this should be set higher when using for specific objectives.
In this example we chose to study the effect of two parameters
<code>cgc</code> and <code>rt_max</code> (<span class="math inline">\(p
=2\)</span>) on two output variables (<span class="math inline">\(y =
2\)</span>) for spinach. Using the ‘one-at-a-time’ design, this will
generate <span class="math inline">\((p+1) \times r\)</span>
simulations, from which the elemental effects are calculated (the
<code>ee</code> variable of the <code><a href="../reference/aquacrop_morris.html">aquacrop_morris()</a></code> output).
As this is typically a multidimensional matrix, we will <em>melt</em>
this into an interpretable dataframe using the
<code><a href="../reference/ee_to_dataframe.html">ee_to_dataframe()</a></code> function, which is built upon the
<code><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">reshape2::melt()</a></code> function.</p>
<p>For more information, please check out the
<code><a href="https://rdrr.io/pkg/sensitivity/man/morris.html" class="external-link">sensitivity::morris()</a></code> function, which is used as a basis
for our <code><a href="../reference/aquacrop_morris.html">aquacrop_morris()</a></code> function.</p>
<p>First we run the Morris method using the
<code><a href="../reference/aquacrop_morris.html">aquacrop_morris()</a></code> function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aquacrop_morris.html">aquacrop_morris</a></span><span class="op">(</span>situation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S_01"</span>, <span class="st">"S_02"</span><span class="op">)</span>,</span>
<span>                     backgroundpar<span class="op">=</span><span class="va">Spinach</span>, </span>
<span>                     cycle_length <span class="op">=</span> <span class="fl">70</span>, </span>
<span>                     r <span class="op">=</span> <span class="fl">20</span>, </span>
<span>                     binf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>rt_max <span class="op">=</span> <span class="fl">0.12</span>, cgc <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, </span>
<span>                     bsup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>rt_max <span class="op">=</span> <span class="fl">0.55</span>, cgc <span class="op">=</span> <span class="fl">0.21</span><span class="op">)</span>, </span>
<span>                     daily_output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                     outvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Biomass"</span>, <span class="st">"CC"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">EE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ee_to_dataframe.html">ee_to_dataframe</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">p</span>, situation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S_01"</span>, <span class="st">"S_02"</span><span class="op">)</span>, cycle_length <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span></code></pre></div>
<p>Now we have a tibble with following columns:</p>
<pre><code><span><span class="co">#&gt; [1] "traject"  "par"      "DAP"      "outvar"   "ee"       "Scenario"</span></span></code></pre>
<p>So we have the elemental effects for each combination of trajectory
(traject - <span class="math inline">\(r = 20\)</span>), parameter (par
- <span class="math inline">\(p = 2\)</span>), simulation time (DAP -
<span class="math inline">\(t = 70\)</span>), output variable (outvar -
<span class="math inline">\(y = 2\)</span>) and scenario (Scenario -
<span class="math inline">\(s = 2\)</span>): <span class="math inline">\(n = r \times p \times t \times y \times s =
11200\)</span>. The actual length of this data frame can be smaller if
some of the trajectories have been rejected, because they were
identical.</p>
<p>As a default, the elemental effects (<code>ee</code>) are scaled for
the parameter value. To make proper comparisons of sensitivity across
output variables, these should also be scaled by dividing by a
representative value for the respective output variable. As an example
we calculate here a <code>scaler</code> based on the 95% highest value
of all simulations done by the <code><a href="../reference/aquacrop_morris.html">aquacrop_morris()</a></code> function
for each variable.<br>
You could also choose e.g. the median value (50%) instead of the 95%
value. As the scaling of the parameter value is already done in the
<code><a href="../reference/aquacrop_morris.html">aquacrop_morris()</a></code> function (based on the parameter ranges
that you provide), we don’t need a representative value there.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="va">scaler</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="va">y</span>, value.name <span class="op">=</span> <span class="st">"value"</span>, varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"simno"</span>, <span class="st">"DAP"</span>, <span class="st">"outvar"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">outvar</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>yscale<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">EE</span> <span class="op">&lt;-</span> <span class="va">EE</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">scaler</span>, by <span class="op">=</span> <span class="st">"outvar"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>ee_scaled <span class="op">=</span> <span class="va">ee</span><span class="op">/</span><span class="va">yscale</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">EE</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">traject</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span>facets <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">outvar</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DAP</span>, y<span class="op">=</span><span class="va">ee_scaled</span>, color <span class="op">=</span> <span class="va">par</span>, linetype <span class="op">=</span> <span class="va">Scenario</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="morris-scaler-1.png" width="720"></p>
<p>This is the output for the elemental effects generated by the third
trajectory. We immediately see that the pattern (i.e. sensitivity
function) is different between output variables and that the importance
of the maximum rooting depth (<code>rt_max</code>) is higher in scenario
<code>S_02</code>, which had a later irrigation event (see
vignette(“example-simulation”)).</p>
<p>Then we aggregate these results on the level we want. The level we
aggregate over is indicated in the <code>group_by()</code> statement. If
we want to rank the parameters on their integrated impact on all two
output variables we only group by <code>par</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_star1</span> <span class="op">&lt;-</span> <span class="va">EE</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span>,</span>
<span>            mu_star <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mu_star1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">par</span>, y<span class="op">=</span><span class="va">mu_star</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="morris-full-1.png" width="720"></p>
<p>If we want to see the effect for each output variable separately, we
add <code>outvar</code> to the <code>group_by()</code> statement:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_star2</span> <span class="op">&lt;-</span> <span class="va">EE</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">par</span>, <span class="va">outvar</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span>,</span>
<span>            mu_star <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mu_star2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span>facets <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">outvar</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">par</span>, y<span class="op">=</span><span class="va">mu_star</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="morris-by_output-1.png" width="720"></p>
<p>Then we can also check if the sensitivity depends on the
scenario:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_star3</span> <span class="op">&lt;-</span> <span class="va">EE</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">par</span>, <span class="va">outvar</span>, <span class="va">Scenario</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span>,</span>
<span>            mu_star <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mu_star3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span>facets <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">outvar</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">par</span>, y<span class="op">=</span><span class="va">mu_star</span>, color <span class="op">=</span> <span class="va">Scenario</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="morris-scenario-1.png" width="720"> We see that
especially the maximum rooting depth effect changes with the
scenario.<br>
Finally, we can look at the time series of the sensitivity. Therefore,
we will also group by <code>DAP</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_star4</span> <span class="op">&lt;-</span> <span class="va">EE</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">par</span>, <span class="va">outvar</span>, <span class="va">Scenario</span>, <span class="va">DAP</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span>,</span>
<span>            mu_star <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">ee_scaled</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">mu_star4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span>facets <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">outvar</span>, <span class="va">Scenario</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">DAP</span>, y<span class="op">=</span><span class="va">mu_star</span>, group<span class="op">=</span><span class="va">par</span>, color<span class="op">=</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="morris-timeseries-1.png" width="720"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tom De Swaef.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
